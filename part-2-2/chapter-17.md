# 클래스 단위 (전통적) 주소 지정

최초의 IP 주소지정 방법에서는 IP 주소 공간을 5개의 서로 다른 크기의 클래스로 나누고, 기관의 크기와 요구에 따라 이들 클래스의 주소 블록을 할당했다.

## IP 클래스 단위 주소지정 개요와 주소 클래스

### IP 주소 클래스

| IP 주소 클래스 | 전체 IP 주소 공간에서 차이하는 비율 | 네트워크 ID 비트의 수 | 호스트 ID 비트의 수 | 용도 
| :----: | :----: | :----: | :----: | :---- |
| 클래스 A | 1/2 | 8 | 24 | 인터넷에 연결할 호스트가 수백만 개 이상 존재하는 매우 큰 기관을 위한 유니태스크 주소 지정 |
| 클래스 B | 1/4 | 16| 16 | 인터넷에 연결할 호스트가 수천 개 정도 존재하는 중규모에서 대규모 기관을 위한 유니캐스트 |
| 클래스 C | 1/8 | 24 | 8 | 인터넷에 연결할 호스트가 약 250개를 넘지 않는 소규모 기관을 위한 유니캐스트 주소 지정 |
| 클래스 D | 1/16 | 없음 | 없음 | IP 멀티캐스팅 |
| 클래스 E | 1/16 | 없음 | 없음 | 테스트용으로 예약됨 |

표 17-1 IP 주소 클래스, 클래스 특성, 용도

![17-2 IPv4 주소 공간을 클래스로 나눔!](http://www.tcpipguide.com/free/diagrams/ipclassfulsplit.png)

- 각 주소 클래스별로 최대 호스트 수가 너무 크다는 것은 주소 할당에 있어서 유연성을 저해 하는 요인이 된다.
- 클래스들은 자신이 포함하는 네트워크 ID와 호스트 ID의 구분점을 어디로 정하는지에 따라 구분된다. 이 구분은 옥텟 단위로 일어난다. 즉 클래스 단위 주소 지정에서는 옥텟 내부에서 네트워크 ID와 호스트 ID가 구분되지 않는다.
- 클래스 D와 E는 특수하다. 클래스 D는 멀티캐스팅에 쓰이고, 클래스 E는 인터넷 설계자들을 위해 테스트용으로 예약돼 있다.

### 클래스 단위 주소지정 방법의 장점

- 단순성과 명확성: 선택할 수 있는 클래스가 몇 개밖에 되지 않아서 이해가 쉽고 구분이 명확하다. 옥텟 단위로 네트워크 ID, 호스트 ID가 구분되기 때문에 특정 주소의 네트워크 ID가 무엇인지 파악하기 쉽다.
- 타당한 유연성: 클래스 A, B, C 세 단계 구분은 대형, 중형, 소형 기관에 잘 들어 맞는다. 당시에는 요구사항 충족이 충분했다.
- 라우팅 용이성: 라우터가 특정 주소의 네트워크 ID, 호스트 ID가 무언인지 쉽게 알 수 있다. 서브넷 마스크와 같은 부가 정보가 필요없다.
- 예약 주소: 미래를 위해 특수 목적으로 예약돼 있다.


## IP 클래스 단위 주소 지정의 네트워크/호스트 식별과 주소 영역

### 클래스 단위 주소 지정의 클래스 결정 알고리즘

라우터는 IP 데이터그램을 어디로 보낼지 빨리 결정할 수 있어야 했다. 그래서 주소 공간은 IP 주소의 처음 몇 비트만을 보고 라우터가 네트워크 ID와 호스트 ID를 파악하고 데이터그램을 어떻게 처리할지 쉽게 파악할 수 있도록 구분됐다.
라우터가 검사해야 할 비트의 수는 비트 값에 따라 1 ~ 4까지 될 수 있다.

![17-2 클래스 단위 IP 주소의 클래스 결정 알고리즘!](http://www.tcpipguide.com/free/diagrams/ipbitalgorithm.png)

### 첫 옥텟 비트 패턴을 통해 주소 클래스 파악
| IP 주소<br />클래스 | IP 주소의<br />첫째 옥텟 | 첫째 옥텟의<br />최소값(2진수) |  첫째 옥텟의<br />최대값 (2진수) | 첫째 옥텟의<br />값의 범위 (10진수) | 네트워크 ID/호스트ID에<br />속한 옥텟 수 | 이론적 IP<br />주소 범위 |
| :----: | :----: | :----: | :----: | :----: | :----: | :---- |
| 클래스A | 0xxx xxxx | 0000 0001 | 0111 1110 | 1~126 | 1/3 | 1.0.0.0 ~ 126.255.255.255 |
| 클래스B | 10xx xxxx | 1000 0000 | 1011 1111 | 128~191 | 2/2 | 128.0.0.0~191.255.255.255 |
| 클래스C | 110x xxxx | 1100 0000 | 1101 1111 | 192~223 | 3/1 | 192.0.0.0~223.255.255.255 |
| 클래스D | 1110 xxxx | 1110 0000 | 1110 1111 | 224~239 | - | 224.0.0.0~239.255.255.255 |
| 클래스E | 1111 xxxx | 1111 0000 | 1111 1111 | 240~255 | - | 240.0.0.0~255.255.255.255 |

![17-3 IP 주소 클래스 비트 할당과 네트워크/호스트 ID의 크기!](http://www.tcpipguide.com/free/diagrams/ipclasses.png)

클래스 A, B, C는 유니캐스트 주소에 쓰이는 보통 클래스로 네트워크 ID와 호스트 ID 구분 지점이 서로 다르다. 하지만 클래스 D와 E는 특수 주소르 네트워크/호스트 ID와 같은 방법으로 구분되지 않는다.

## IP 주소 클래스 A, B, C의 네트워크와 호스트 용량
| IP 주소 클래스 | 네트워크/호스트에 쓰이는 비트수 | IP 주소의 첫째 옥텟 | 클래스 식별에 쓰이는 네트워크 ID 비트수 | 사용 가능한 네트워크 ID 비트 | 사용 가능한 네트워크 ID의 수 | 네트워크 ID 별 호스트 ID의 수 |
| :----: | :----: | :----: | :----: | :----: | :----: | :----: |
| 클래스A | 8/24 | 0xxx xxxx | 1 | 8-1=7 | $$2^7-2=126$$ | 2<sup>24</sup>-2=16,277,214 |
| 클래스B | 16/16 | 10xx xxxx | 2 | 16-2=14 | 2<sup>14</sup>-2=16,384 | 2<sup>16</sup>-2=65,534 |
| 클래스C | 24/8 | 110x xxxx | 3 | 24-3=21 | 2<sup>21</sup>-2=2,097,152 | 2<sup>8</sup>-2=254 |

> 만약 어떤 기관에서 1,000개의 IP 주소를 필요로 한다면? 그 기관은 4개의 클래스 C 네트워크 또는 하나의 클래스 B 네트워크를 사용해야 한다. (이 경우 B 클래스의 90%를 낭비하게 된다) 전 세계적으로 사용할 수 있는 클래스 B의 네트워크 ID 수는 약 16,000개에 불과하다.

## 특수 의미를 갖는 IP 주소

특수 주소는 IP 주소의 일반 네트워크 ID나 호스트 ID를 다음 두 가지 특수 패턴 중 하나로 바꿔서 만들 수 있다.
- 모두 0: 네트워크 ID나 호스트ID 비트가 모두 0으로 치환되는 주소는 "이것" 이라는 의미를 갖는다. 
- 모두 1: 네트워크 ID나 호스트ID 비트가 모두 1로 치환된 주소는 모든 주소, 즉 네트워크에 있는 모든 호스트를 가리키는 IP 주소를 의미한다. 일반적으로 모든 사람에게 메시지를 보내기 위한 <font color="orange">브로드캐스트 주소</font>로 쓰인다.

> IP 주소의 네트워크 ID나 호스트 ID가 모두 1이나 0으로 바뀌면 그 주소는 특수 의미를 갖는다. 그러한 주소의 예로 "모든 호스트"를 가리키는 브로드캐스트 주소와 특정 호스트 또는 전체 네트워크를 가리키는 주소를 들 수 있다.

![표17-4 특수 의미를 갖는 IP주소 패턴!](https://github.com/nccho/study-tcp-ip/blob/main/resources/17-4-%ED%8A%B9%EC%88%98%EC%9D%98%EB%AF%B8%EB%A5%BC%EA%B0%96%EB%8A%94IP%EC%A3%BC%EC%86%8C%ED%8C%A8%ED%84%B4.png?raw=true)

## IP 예약, 사설, 루프백 주소

특수한 용도로 쓰이는 주소
- 예약: 향후에 있을 테스트나 내부 관리용도의 예약 IP 주소
- 사설: 사설 네트워크에서는 원하는 주소를 사용할 수 있다. 하지만 사설 네트워크를 공중 인터넷으로 연결시 문제가 발생한다. RFC-1918은 그에 대한 해결책을 내 놓앗다. 사설 주소에만 사용할 수 있는, 라우팅이 불가능한 특수 주소 집합을 정의했다.  
사설 주소를 사용하는 네트워크를 공중 인터넷에 연결하려면 추가 하드웨어와 소프트웨어를 도입해야 한다. NAT 기술을 통해 사설 IP 주소를 갖는 호스트는 공중 IP 네트워크에 있는 호스트와 통신할 수 있다.
- 루프백 주소: 127.0.0.0 ~ 127.255.255.255 까지의 특수 범위는 루프백 기능을 위해 예약돼 있다. 호스트가 루프백 주소로 보낸 IP 데이터 그램은 데이터 링크 계층으로 전달되지 않고 출발지 장비의 IP 계층으로 되돌아 온다.

![표17-5 예약, 사설, 루프백 IP 주소!](https://github.com/nccho/study-tcp-ip/blob/main/resources/17-5-%EC%98%88%EC%95%BD-%EC%82%AC%EC%84%A4-%EB%A3%A8%ED%94%84%EB%B0%B1IP%EC%A3%BC%EC%86%8C.png?raw=true)

## IP 멀티캐스트 주소 지정

클래스 단위 IP 주소  지정 방법에서 전체 주소 공간의 1/16 인 멀티캐스트 주소 공간을 클래스 D로 할당 했다. 멀티캐스트 주소의 전체 범위는 224.0.0.0 ~ 239.255.255.255 까지다.

### 멀티캐스트 주소 유형과 범위

![표17-6 IP 멀티캐스트 주소 범위와 용도!](https://github.com/nccho/study-tcp-ip/blob/main/resources/17-6-IP%EB%A9%80%ED%8B%B0%EC%BA%90%EC%8A%A4%ED%8A%B8%EC%A3%BC%EC%86%8C%EB%B2%94%EC%9C%84%EC%99%80%EC%9A%A9%EB%8F%84.png?raw=true)

> 다른 IP 주소 클래스와 마찬가지로 멀티캐스트에서도 주소의 32비트가 모두 쓰인다. 그렇지만 그중에서 흥미로운 것은 하위 28비트다. 왜냐하면 상위 4비트는 변하지 않기 때문이다.

![17-4 IP 멀티캐스트 주소의 범위와 용도!](https://github.com/nccho/study-tcp-ip/blob/main/resources/17-4-p-IP%EB%A9%80%ED%8B%B0%EC%BA%90%EC%8A%A4%ED%8A%B8%20%EC%A3%BC%EC%86%8C%20%EB%B2%94%EC%9C%84%EC%99%80%20%EC%9A%A9%EB%8F%84.png?raw=true)

모든 멀티캐스트 주소는 1110으로 시작한다. 유명 멀티캐스트 주소 그룹은 멀티캐스트 그룹 주소의 처음 20비타그 0이고 그 뒤에 255개의 특수 멀티캐스트 주소를 정의하기 위한 8비트가 붙는다. 1110 1111로 시작하는 멀티캐스트 주소는 로컬 주소다. 그 밖의 모든 주소는 전역 범위 주소다 (이것은 1110 0000으로 시작하는 주소 중 255개의 유명 주소를 제외한 주소도 포함한다)

> 멀티캐스트 주소 범위의 개념은 IPv6에서 좀 더 완전하게 정의돼있다.

### 유명 멀티캐스트 주소

![표17-7 유명 IP 멀티캐스트 주소!](https://github.com/nccho/study-tcp-ip/blob/main/resources/17-7-t-%EC%9C%A0%EB%AA%85IP%EB%A9%80%ED%8B%B0%EC%BA%90%EC%8A%A4%ED%8A%B8%EC%A3%BC%EC%86%8C.png?raw=true)
멀티캐스트 트래픽은 여러 수신자에게 전달되어야 하기 때문에 유니캐스트 트래픽보다 전달하는 과정이 복잡하다. 유니캐스트 데이터그램에서 주소 결정 프로토콜을(ARP) 사용하여 주소를 결정하는 것과 달리 멀티캐스트에서는 IP 멀티캐스트 그룹과 하드웨어 멀티캐스트 그룹을 매핑한다.

## 클래스 단위 IP 주소 지정의 문제점

- 내부 주소 유연성 부족: 대형 기관의 커다란 단일 주소 블록을 할당받는데 그것은 내부 네트워크의 구조를 적절히 반영할 수 없다.
- 주소 공간의 비효율적 사용: 오직 세 가지 블록 크기(클래스 A, B, C) 밖에 없기 때문에 한정된 IP 주소 공간을 낭비한다.
- 라우터 테이블 항목이 너무 커짐: 인터넷이 성장하면서 IP 데이터그램을 라우팅하기 위해 점점 더 많은 항목이 라우터에 추가됐다. 이로 인해 라우터는 성능 문제를 겪고 있다. 비효율적인 주소 공간 할당을 줄이려고 하면 더 많은 라우터 테이블 항목이 필요하다.
